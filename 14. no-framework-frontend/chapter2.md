## 렌더링

W3C에서는 프로그래밍 방식으로 요소를 렌더링하는 방식을 문서 객체 모델(Document Object Model) 로 정의했다.

### 문서객체모델(DOM)

DOM은 웹 어플리케이션을 구성하는 요소를 조작할 수 있는 API이다.
DOM 은 HTML 요소로 정의된 트리를 관리하는 방법이라고도 할 수 있는데, 특정 셀의 배경색을 변경하려면 다음과 같다.

```javascript
const SELECTOR = "tr:nth-child(3) > td";
const cell = document.querySelector(SELECTOR);
cell.style.backgroundColor = "red";
```

여기서 querySelector 의 경우 Node 의 메서드인데, Node는 HTML 트리에서 노드를 나타내는 기본 인터페이스이다.

### 렌더링 성능 모니터링

웹용 렌더링 엔진을 설계할 때는 가독성과 유지 관리성을 염두해야 한다.

우선적으로 크롬의 개발자도구에서 show fps 검색 시 실제 Frame Rate 를 표시해주는 FPS 미터를 열 수 있다.

또 하나의 방법이라면 stats.js 라는 라이브러리를 사용하는 것인데, 브라우저를 가리지않고 위젯처럼 브라우저 위에 표시될 수 있도록 할 수 있다.

### 렌더링 함수

순수하게 함수를 사용해 요소를 DOM에 렌더링 하는 다양한 방법이 있다.

view = f(state)

순수하게 함수로서 요소를 렌더링 한다는 것은 함수가 상태에만 의존한다는 의미인데, 이는 추후에 더 다뤄보도록 한다.

todo app 을 통해서 이러한 렌더링을 다루는 방식에 대해서 코드적으로 확인할 수 있다 (todo-mvc)

### 레지스트리

todo list 내에서 어떠한 리스트가 변했거나, 체크 상태나 명칭변화 등의 변화에 대해서 각각 나누어진 view 함수들을 수동적으로 적합하게 호출해야 한다는 특징이 존재하는데, 구성 요소 기반의 애플리케이션을 작성하려면 구성 요소간의 상호작용에 선언적 방식을 사용해야 한다.

현재 예제에서는 각 엘리먼트 내 data-component 라는 속성을 추가하였다 (커스텀)
이제 렌더함수가 실행될 때, 자동적으로 data-component 에 매칭된 name 에 해당하는 view 를 실행시키도록 레지스트리에 등록하면 좋다.

### diff 알고리즘

렌더링 효율을 위해 가상 DOM 을 생성하여 실제 DOM 과의 변경사항을 비교하여 실제 DOM의 업데이트를 최소화 시킨다.

diff 는 기본적으로 3가지 작업을 진행하는데

- 실제 DOM에 없고 가상 DOM 에 있다면 추가
- 실제 DOM에 있고 가상 DOM 에 없다면 삭제
- 둘 다 있다면 isNodeChange 를 기반으로 적용

여기서 isNodeChange 가 구분하고자 하는 바는 다음과 같다.

- 두 노드의 속성 배열의 길이의 차이
- 두 노드의 같은 속성에 대한 값의 차이
- 자식이 없는 노드의 Text 의 차이

3가지를 비교하여 차이가 하나라도 있다면 replaceWith 를 진행한다.
