# í”„ë ˆì„ì›Œí¬ ì—†ëŠ” ì„ ì–¸í˜• Todo ì• í”Œë¦¬ì¼€ì´ì…˜ - ë Œë”ë§ ê³¼ì • ë¶„ì„

## ëª©ì°¨

- [[#ì•„í‚¤í…ì²˜ ê°œìš”|ì•„í‚¤í…ì²˜ ê°œìš”]]
- [[#ë Œë”ë§ ê³¼ì • ìƒì„¸ ë¶„ì„|ë Œë”ë§ ê³¼ì • ìƒì„¸ ë¶„ì„]]
- [[#í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ë¶„ì„|í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ë¶„ì„]]
- [[#ì¥ì |ì¥ì ]]
- [[#ë‹¨ì |ë‹¨ì ]]
- [[#ê°œì„  ê°€ëŠ¥í•œ ë¶€ë¶„|ê°œì„  ê°€ëŠ¥í•œ ë¶€ë¶„]]

---

## ì•„í‚¤í…ì²˜ ê°œìš”

ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ **í”„ë ˆì„ì›Œí¬ ì—†ì´ ì„ ì–¸í˜• ë Œë”ë§**ì„ êµ¬í˜„í•œ Todo ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

### í•µì‹¬ ê°œë…

```
State (ìƒíƒœ)
  â†“
View Functions (ìˆœìˆ˜ í•¨ìˆ˜)
  â†“
Virtual DOM (ê°€ìƒ DOM)
  â†“
Diff Algorithm (ì°¨ì´ ë¹„êµ)
  â†“
Real DOM Update (ì‹¤ì œ DOM ì—…ë°ì´íŠ¸)
```

### íŒŒì¼ êµ¬ì¡°

```
compact/
â”œâ”€â”€ index.html          # HTML í…œí”Œë¦¿
â”œâ”€â”€ index.js           # ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì , ìƒíƒœ ê´€ë¦¬
â”œâ”€â”€ registry.js        # ì»´í¬ë„ŒíŠ¸ ë“±ë¡ ì‹œìŠ¤í…œ
â”œâ”€â”€ applyDiff.js       # Diff ì•Œê³ ë¦¬ì¦˜ (ê°€ìƒ DOM â†” ì‹¤ì œ DOM)
â”œâ”€â”€ getTodos.js        # Mock ë°ì´í„° ìƒì„±
â””â”€â”€ view/
    â”œâ”€â”€ todos.js       # Todo ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸
    â”œâ”€â”€ filters.js     # í•„í„° ì»´í¬ë„ŒíŠ¸
    â””â”€â”€ counter.js     # ì¹´ìš´í„° ì»´í¬ë„ŒíŠ¸
```

---

## ë Œë”ë§ ê³¼ì • ìƒì„¸ ë¶„ì„

### 1. ì „ì²´ ë Œë”ë§ íë¦„

```
[State ë³€ê²½]
  â†“
render() í˜¸ì¶œ
  â†“
requestAnimationFrameìœ¼ë¡œ ë‹¤ìŒ í”„ë ˆì„ì— ì‹¤í–‰ ì˜ˆì•½
  â†“
registry.renderRoot() - ê°€ìƒ DOM ìƒì„±
  â”œâ”€ ë£¨íŠ¸ ìš”ì†Œ ë³µì œ
  â”œâ”€ ê° ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ (ìˆœìˆ˜ í•¨ìˆ˜)
  â””â”€ ìì‹ ì»´í¬ë„ŒíŠ¸ ìë™ ë Œë”ë§
  â†“
applyDiff() - Diff ì•Œê³ ë¦¬ì¦˜ ì‹¤í–‰
  â”œâ”€ ì‹¤ì œ DOMê³¼ ê°€ìƒ DOM ë¹„êµ
  â”œâ”€ ë³€ê²½ëœ ë¶€ë¶„ë§Œ ì‹ë³„
  â””â”€ ìµœì†Œí•œì˜ DOM ì¡°ì‘ìœ¼ë¡œ ì—…ë°ì´íŠ¸
  â†“
[í™”ë©´ ì—…ë°ì´íŠ¸ ì™„ë£Œ]
```

### 2. ë‹¨ê³„ë³„ ìƒì„¸ ë¶„ì„

#### ë‹¨ê³„ 1: State ë³€ê²½ ë° render() í˜¸ì¶œ

```javascript:index.js
const state = {
  todos: getTodos(),
  currentFilter: "All",
};

const render = () => {
  window.requestAnimationFrame(() => {
    const main = document.querySelector(".todoapp");
    const newMain = registry.renderRoot(main, state);
    applyDiff(document.body, main, newMain);
  });
};

window.setInterval(() => {
  state.todos = getTodos();
  render();
}, 1000);

render();
```

**ë™ì‘:**

1. `state` ê°ì²´ì— ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ ì €ì¥
2. `render()` í˜¸ì¶œ ì‹œ `requestAnimationFrame`ìœ¼ë¡œ ë‹¤ìŒ í”„ë ˆì„ì— ì‹¤í–‰ ì˜ˆì•½
3. **`setInterval`ë¡œ 1ì´ˆë§ˆë‹¤ `render()` í˜¸ì¶œ** (ì™¸ë¶€ íŠ¸ë¦¬ê±°)

**âš ï¸ í˜„ì¬ êµ¬í˜„ ìƒíƒœ (ì‹œì‘ ë‹¨ê³„):**

í˜„ì¬ ì½”ë“œëŠ” **ì‹œì‘ ë‹¨ê³„**ì´ë©°, `requestAnimationFrame`ì„ ì¬ê·€ í˜¸ì¶œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

**í˜„ì¬ ë™ì‘ ë°©ì‹:**

```
0ms: render() í˜¸ì¶œ â†’ requestAnimationFrame ì˜ˆì•½
16.67ms: RAF ì½œë°± ì‹¤í–‰ (ë Œë”ë§ ì™„ë£Œ) â†’ ë
1000ms: setInterval íŠ¸ë¦¬ê±° â†’ render() í˜¸ì¶œ â†’ requestAnimationFrame ì˜ˆì•½
1016.67ms: RAF ì½œë°± ì‹¤í–‰ (ë Œë”ë§ ì™„ë£Œ) â†’ ë
2000ms: setInterval íŠ¸ë¦¬ê±° â†’ render() í˜¸ì¶œ â†’ requestAnimationFrame ì˜ˆì•½
...
```

**í˜„ì¬ êµ¬í˜„ì˜ íŠ¹ì§•:**

- âœ… **ìƒíƒœ ê¸°ë°˜ ë Œë”ë§**: ìƒíƒœê°€ ë³€ê²½ë  ë•Œë§Œ ë Œë”ë§ (ì˜ë„ëœ ë™ì‘)
- âœ… **requestAnimationFrameì˜ ì—­í• **: ë¸Œë¼ìš°ì € ë Œë”ë§ ì‚¬ì´í´ê³¼ ë™ê¸°í™”
- âš ï¸ **ì™¸ë¶€ íŠ¸ë¦¬ê±° ì‚¬ìš©**: í˜„ì¬ëŠ” `setInterval`ë¡œ ìƒíƒœ ë³€ê²½ì„ ì‹œë®¬ë ˆì´ì…˜
- âš ï¸ **ìˆ˜ë™ render() í˜¸ì¶œ**: ìƒíƒœ ë³€ê²½ ì‹œ ìˆ˜ë™ìœ¼ë¡œ `render()` í˜¸ì¶œ í•„ìš”

**Reactì™€ì˜ ë¹„êµ:**

```javascript
// Reactì˜ íŒ¨í„´ (ëª©í‘œ)
const [todos, setTodos] = useState([]);

// ìƒíƒœ ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ ë¦¬ë Œë”ë§
setTodos(newTodos); // ìë™ìœ¼ë¡œ render() í˜¸ì¶œë¨

// í˜„ì¬ ì½”ë“œ (í˜„ì¬ ë‹¨ê³„)
state.todos = getTodos(); // ìƒíƒœ ë³€ê²½
render(); // ìˆ˜ë™ìœ¼ë¡œ í˜¸ì¶œ í•„ìš” (í–¥í›„ ê°œì„  ì˜ˆì •)
```

**í–¥í›„ ê°œì„  ë°©í–¥:**

í˜„ì¬ ì½”ë“œëŠ” **ì‹œì‘ ë‹¨ê³„**ì´ë©°, í–¥í›„ ë‹¤ìŒê³¼ ê°™ì´ ê°œì„ ë  ì˜ˆì •ì…ë‹ˆë‹¤:

1. **ìƒíƒœ ë³€ê²½ ê°ì§€**: Proxyë‚˜ Observer íŒ¨í„´ìœ¼ë¡œ ìƒíƒœ ë³€ê²½ ìë™ ê°ì§€
2. **ìë™ ë Œë”ë§**: ìƒíƒœ ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ `render()` í˜¸ì¶œ
3. **ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬**: ì‚¬ìš©ì ì¸í„°ë™ì…˜ì— ë”°ë¥¸ ìƒíƒœ ë³€ê²½ ë° ìë™ ë Œë”ë§

```javascript
// í–¥í›„ ê°œì„  ì˜ˆì‹œ (ì˜ˆìƒ)
const state = createReactiveState({
  todos: getTodos(),
  currentFilter: "All",
});

// ìƒíƒœ ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ render() í˜¸ì¶œ
state.todos = getTodos(); // ìë™ìœ¼ë¡œ render() íŠ¸ë¦¬ê±°ë¨
```

**requestAnimationFrameì˜ ì—­í• :**

- ì¬ê·€ í˜¸ì¶œì´ ì—†ëŠ” ê²ƒì€ **ì˜ë„ëœ ê²ƒ**ì…ë‹ˆë‹¤
- ìƒíƒœ ë³€ê²½ ê¸°ë°˜ ë Œë”ë§ì´ë¯€ë¡œ, ìƒíƒœê°€ ë³€ê²½ë  ë•Œë§Œ ë Œë”ë§í•©ë‹ˆë‹¤
- `requestAnimationFrame`ì€ ë¸Œë¼ìš°ì € ë Œë”ë§ ì‚¬ì´í´ê³¼ ë™ê¸°í™”í•˜ì—¬ ì„±ëŠ¥ì„ ìµœì í™”í•˜ëŠ” ìš©ë„ì…ë‹ˆë‹¤
- ë§¤ í”„ë ˆì„ë§ˆë‹¤ ë Œë”ë§í•  í•„ìš”ê°€ ì—†ëŠ” ê²½ìš°ì— ì í•©í•œ íŒ¨í„´ì…ë‹ˆë‹¤

#### ë‹¨ê³„ 2: ê°€ìƒ DOM ìƒì„± (registry.renderRoot)

```javascript:registry.js
const renderRoot = (root, state) => {
  const cloneComponent = (root) => {
    return root.cloneNode(true);
  };

  return renderWrapper(cloneComponent)(root, state);
};
```

**ë™ì‘:**

1. ì‹¤ì œ DOM ìš”ì†Œë¥¼ `cloneNode(true)`ë¡œ ë³µì œ (ê¹Šì€ ë³µì‚¬)
2. `renderWrapper`ë¡œ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ë˜í•‘
3. `data-component` ì†ì„±ì„ ê°€ì§„ ìì‹ ìš”ì†Œë“¤ì„ ìë™ìœ¼ë¡œ ì°¾ì•„ ë Œë”ë§

#### ë‹¨ê³„ 3: ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ (renderWrapper)

```javascript:registry.js
const renderWrapper = (component) => {
  return (targetElement, state) => {
    const element = component(targetElement, state); // targetElement ì—ì„œëŠ” root ë„ ë“¤ì–´ê°€ê³ , ë§ ê·¸ëŒ€ë¡œ target ì´ ë“¤ì–´ê°

    // ìì‹ ì»´í¬ë„ŒíŠ¸ë¥¼ ì°¾ì•„ì„œ ë“±ë¡
    const childComponents = element.querySelectorAll("[data-component]");

    Array.from(childComponents).forEach((target) => {
      const name = target.dataset.component; // "data-component" ë¥¼ ë§¤ì¹­
      const child = registry[name]; // registry ë‚´ ì €ì¥ëœ ë¶€ë¶„ì€ renderWrapper(nameFunction) ì„
      if (!child) return;

      target.replaceWith(child(target, state)); // í˜„ state ë¥¼ ë°›ì•„ state ë³€ê²½ í›„ target ì— replace ì‹¤í–‰
    });

    return element;
  };
};
```

**ë™ì‘:**

1. ì»´í¬ë„ŒíŠ¸ í•¨ìˆ˜ ì‹¤í–‰í•˜ì—¬ ìƒˆ ìš”ì†Œ ìƒì„±
2. `data-component` ì†ì„±ì„ ê°€ì§„ ìì‹ ìš”ì†Œ íƒìƒ‰
3. ë“±ë¡ëœ ìì‹ ì»´í¬ë„ŒíŠ¸ë¥¼ ì°¾ì•„ ì¬ê·€ì ìœ¼ë¡œ ë Œë”ë§
4. **ì„ ì–¸í˜• ë Œë”ë§**: HTMLì— `data-component`ë§Œ ì„ ì–¸í•˜ë©´ ìë™ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ ì—°ê²°

#### ë‹¨ê³„ 4: View í•¨ìˆ˜ ì‹¤í–‰ (ìˆœìˆ˜ í•¨ìˆ˜)

ê° ì»´í¬ë„ŒíŠ¸ëŠ” **ìˆœìˆ˜ í•¨ìˆ˜**ë¡œ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

```javascript:view/todos.js
export default (targetElement, { todos }) => {
  const newTodoList = targetElement.cloneNode(true);
  const todoElements = todos.map(getTodoElement).join("");
  newTodoList.innerHTML = todoElements;
  return newTodoList;
};
```

**íŠ¹ì§•:**

- ì…ë ¥: `targetElement` (ê¸°ì¡´ ìš”ì†Œ), `state` (ìƒíƒœ)
- ì¶œë ¥: ìƒˆë¡œìš´ DOM ìš”ì†Œ
- **ë¶€ìˆ˜ íš¨ê³¼ ì—†ìŒ**: ê¸°ì¡´ DOMì„ ì§ì ‘ ìˆ˜ì •í•˜ì§€ ì•Šê³  ìƒˆ ìš”ì†Œ ë°˜í™˜

#### ë‹¨ê³„ 5: Diff ì•Œê³ ë¦¬ì¦˜ (applyDiff)

```javascript:applyDiff.js
const applyDiff = (parentNode, realNode, virtualNode) => {
  // 1. ì‹¤ì œ ë…¸ë“œì—ëŠ” ìˆì§€ë§Œ ê°€ìƒ ë…¸ë“œì—ëŠ” ì—†ë‹¤ë©´ ì‚­ì œ
  if (realNode && !virtualNode) {
    realNode.remove();
    return;
  }

  // 2. ê°€ìƒ ë…¸ë“œì—ëŠ” ìˆì§€ë§Œ ì‹¤ì œ ì—†ë‹¤ë©´ ì¶”ê°€
  if (!realNode && virtualNode) {
    parentNode.appendChild(virtualNode);
    return;
  }

  // 3. ë…¸ë“œê°€ ë³€ê²½ë˜ì—ˆë‹¤ë©´ êµì²´
  if (isNodeChanged(virtualNode, realNode)) {
    realNode.replaceWith(virtualNode);
    return;
  }

  // 4. ìì‹ ë…¸ë“œë“¤ì— ëŒ€í•´ ì¬ê·€ì ìœ¼ë¡œ ì ìš©
  const realChildren = Array.from(realNode.children);
  const virtualChildren = Array.from(virtualNode.children);
  const max = Math.max(realChildren.length, virtualChildren.length);

  for (let i = 0; i < max; i++) {
    applyDiff(realNode, realChildren[i], virtualChildren[i]);
  }
};
```

**ë™ì‘:**

1. **ë…¸ë“œ ì¡´ì¬ ì—¬ë¶€ í™•ì¸**: ì¶”ê°€/ì‚­ì œ ì²˜ë¦¬
2. **ë…¸ë“œ ë³€ê²½ ê°ì§€**: `isNodeChanged`ë¡œ ì†ì„±, í…ìŠ¤íŠ¸ ë¹„êµ
3. **ì¬ê·€ì  ë¹„êµ**: ìì‹ ë…¸ë“œë“¤ì— ëŒ€í•´ ë™ì¼í•œ ê³¼ì • ë°˜ë³µ
4. **ìµœì†Œí•œì˜ DOM ì¡°ì‘**: ë³€ê²½ëœ ë¶€ë¶„ë§Œ ì—…ë°ì´íŠ¸

#### ë‹¨ê³„ 6: ë…¸ë“œ ë³€ê²½ ê°ì§€ (isNodeChanged)

```javascript:applyDiff.js
const isNodeChanged = (nodeA, nodeB) => {
  // 1. ì†ì„± ê°œìˆ˜ ë¹„êµ
  if (n1Attributes.length !== n2Attributes.length) return true;

  // 2. ì†ì„± ê°’ ë¹„êµ
  const differentAttributes = Array.from(n1Attributes).find((attribute) => {
    const { name } = attribute;
    const n1Value = nodeA.getAttribute(name);
    const n2Value = nodeB.getAttribute(name);
    return n1Value !== n2Value;
  });

  if (differentAttributes) return true;

  // 3. í…ìŠ¤íŠ¸ ë‚´ìš© ë¹„êµ (ìì‹ ë…¸ë“œê°€ ì—†ëŠ” ê²½ìš°)
  if (
    nodeA.children.length === 0 &&
    nodeB.children.length === 0 &&
    nodeA.textContent !== nodeB.textContent
  ) {
    return true;
  }

  return false;
};
```

**ë¹„êµ í•­ëª©:**

1. ì†ì„± ê°œìˆ˜
2. ì†ì„± ê°’
3. í…ìŠ¤íŠ¸ ë‚´ìš© (ë¦¬í”„ ë…¸ë“œì¸ ê²½ìš°)

---

## í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ë¶„ì„

### 1. Registry (ì»´í¬ë„ŒíŠ¸ ë“±ë¡ ì‹œìŠ¤í…œ)

```javascript:registry.js
const registry = {};

const add = (name, component) => {
  registry[name] = renderWrapper(component);
};
```

**ì—­í• :**

- ì»´í¬ë„ŒíŠ¸ë¥¼ ì´ë¦„ìœ¼ë¡œ ë“±ë¡
- `renderWrapper`ë¡œ ë˜í•‘í•˜ì—¬ ìì‹ ì»´í¬ë„ŒíŠ¸ ìë™ ë Œë”ë§ ê¸°ëŠ¥ ì¶”ê°€

**ì‚¬ìš© ì˜ˆì‹œ:**

```javascript:index.js
registry.add("todos", todosView);
registry.add("filter", filterView);
registry.add("counter", counterView);
```

### 2. View ì»´í¬ë„ŒíŠ¸ë“¤

#### todos.js - Todo ë¦¬ìŠ¤íŠ¸

```javascript:view/todos.js
const getTodoElement = (todo) => {
  const { text, completed } = todo;
  return `
    <li ${completed ? 'class="completed"' : ""}>
      <div class="view">
        <input ${completed ? "checked" : ""} class="toggle" type="checkbox">
        <label>${text}</label>
        <button class="destroy"></button>
      </div>
      <input class="edit" value="${text}">
    </li>
  `;
};

export default (targetElement, { todos }) => {
  const newTodoList = targetElement.cloneNode(true);
  const todoElements = todos.map(getTodoElement).join("");
  newTodoList.innerHTML = todoElements;
  return newTodoList;
};
```

**íŠ¹ì§•:**

- ìƒíƒœ(`todos`)ë¥¼ ë°›ì•„ HTML ë¬¸ìì—´ ìƒì„±
- ê¸°ì¡´ ìš”ì†Œë¥¼ ë³µì œí•˜ì—¬ ìƒˆ ìš”ì†Œ ë°˜í™˜

#### filters.js - í•„í„° ë²„íŠ¼

```javascript:view/filters.js
export default (targetElement, { currentFilter }) => {
  const newCounter = targetElement.cloneNode(true);

  Array.from(newCounter.querySelectorAll("li a")).forEach((a) => {
    if (a.textContent === currentFilter) {
      a.classList.add("selected");
    } else {
      a.classList.remove("selected");
    }
  });

  return newCounter;
};
```

**íŠ¹ì§•:**

- í˜„ì¬ ì„ íƒëœ í•„í„°ì— `selected` í´ë˜ìŠ¤ ì¶”ê°€
- DOM ì¡°ì‘ì„ ìµœì†Œí™”í•˜ì—¬ ì„±ëŠ¥ ìµœì í™”

#### counter.js - Todo ê°œìˆ˜

```javascript:view/counter.js
const getTodoCount = (todos) => {
  const notCompleted = todos.filter((todo) => !todo.completed);
  const { length } = notCompleted;

  if (length === 1) {
    return "1 item left";
  }
  return `${length} items left`;
};

export default (targetElement, { todos }) => {
  const newCounter = targetElement.cloneNode(true);
  newCounter.textContent = getTodoCount(todos);
  return newCounter;
};
```

**íŠ¹ì§•:**

- ì™„ë£Œë˜ì§€ ì•Šì€ Todo ê°œìˆ˜ ê³„ì‚°
- ë‹¨ìˆ˜/ë³µìˆ˜ í˜•íƒœ ì²˜ë¦¬

### 3. HTMLê³¼ì˜ ì—°ê²°

```html:index.html
<ul class="todo-list" data-component="todos"></ul>
<span class="todo-count" data-component="counter">1 Item Left</span>
<ul class="filters" data-component="filters">
  <li><a href="#/">All</a></li>
  <li><a href="#/active">Active</a></li>
  <li><a href="#/completed">Completed</a></li>
</ul>
```

**íŠ¹ì§•:**

- `data-component` ì†ì„±ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ ì—°ê²°
- **ì„ ì–¸í˜•**: HTMLì— ì»´í¬ë„ŒíŠ¸ ì´ë¦„ë§Œ ì„ ì–¸í•˜ë©´ ìë™ìœ¼ë¡œ ì—°ê²°
- ì´ˆê¸° HTML êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ë©´ì„œ ë™ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸

---

## ì¥ì 

### 1. í”„ë ˆì„ì›Œí¬ ë…ë¦½ì„±

- âœ… **ì˜ì¡´ì„± ì—†ìŒ**: ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆí•„ìš”
- âœ… **ë²ˆë“¤ í¬ê¸° ì‘ìŒ**: ìµœì†Œí•œì˜ ì½”ë“œë¡œ êµ¬í˜„
- âœ… **í•™ìŠµ ê³¡ì„  ë‚®ìŒ**: ìˆœìˆ˜ JavaScriptë§Œ ì‚¬ìš©

### 2. ì„ ì–¸í˜• ë Œë”ë§

- âœ… **ìˆœìˆ˜ í•¨ìˆ˜**: View = f(State) íŒ¨í„´
- âœ… **ì˜ˆì¸¡ ê°€ëŠ¥**: ê°™ì€ ì…ë ¥ â†’ ê°™ì€ ì¶œë ¥
- âœ… **í…ŒìŠ¤íŠ¸ ìš©ì´**: ë¶€ìˆ˜ íš¨ê³¼ ì—†ì–´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‰¬ì›€

### 3. ì„±ëŠ¥ ìµœì í™”

- âœ… **requestAnimationFrame**: ë¸Œë¼ìš°ì € ë Œë”ë§ ì‚¬ì´í´ê³¼ ë™ê¸°í™”
- âœ… **Diff ì•Œê³ ë¦¬ì¦˜**: ë³€ê²½ëœ ë¶€ë¶„ë§Œ ì—…ë°ì´íŠ¸
- âœ… **ìµœì†Œí•œì˜ DOM ì¡°ì‘**: ë¶ˆí•„ìš”í•œ ë¦¬í”Œë¡œìš°/ë¦¬í˜ì¸íŠ¸ ë°©ì§€

### 4. ì»´í¬ë„ŒíŠ¸ ì‹œìŠ¤í…œ

- âœ… **ìë™ ì»´í¬ë„ŒíŠ¸ íƒìƒ‰**: `data-component` ì†ì„±ìœ¼ë¡œ ìë™ ì—°ê²°
- âœ… **ì¬ì‚¬ìš© ê°€ëŠ¥**: ì»´í¬ë„ŒíŠ¸ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬
- âœ… **í™•ì¥ ìš©ì´**: ìƒˆ ì»´í¬ë„ŒíŠ¸ ì¶”ê°€ê°€ ê°„ë‹¨

### 5. ê°€ìƒ DOM íŒ¨í„´

- âœ… **ì„ ì–¸ì  ì—…ë°ì´íŠ¸**: ìƒíƒœë§Œ ë³€ê²½í•˜ë©´ ìë™ìœ¼ë¡œ UI ì—…ë°ì´íŠ¸
- âœ… **íš¨ìœ¨ì ì¸ ë¹„êµ**: ì‹¤ì œ DOMê³¼ ê°€ìƒ DOM ë¹„êµë¡œ ìµœì í™”
- âœ… **Reactì™€ ìœ ì‚¬í•œ íŒ¨í„´**: í”„ë ˆì„ì›Œí¬ ê°œë… ì´í•´ì— ë„ì›€

---

## ë‹¨ì 

### 1. ê¸°ëŠ¥ ì œí•œ

- âŒ **ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ê´€ë¦¬ ë¶€ì¬**: í˜„ì¬ ì½”ë“œì—ëŠ” ì´ë²¤íŠ¸ ë°”ì¸ë”© ë¡œì§ ì—†ìŒ
- âŒ **ìƒíƒœ ê´€ë¦¬ ë‹¨ìˆœ**: ë³µì¡í•œ ìƒíƒœ ê´€ë¦¬ íŒ¨í„´ ë¶€ì¬
- âŒ **ë¼ì´í”„ì‚¬ì´í´ ì—†ìŒ**: ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸/ì–¸ë§ˆìš´íŠ¸ ì²˜ë¦¬ ì—†ìŒ

### 2. ì„±ëŠ¥ ì´ìŠˆ

- âŒ **ì „ì²´ íŠ¸ë¦¬ ë¹„êµ**: í° DOM íŠ¸ë¦¬ì—ì„œ ì„±ëŠ¥ ì €í•˜ ê°€ëŠ¥
- âŒ **ë¶ˆí•„ìš”í•œ ë³µì œ**: `cloneNode(true)`ë¡œ ì „ì²´ ìš”ì†Œ ë³µì œ
- âŒ **ë¬¸ìì—´ ê¸°ë°˜ ë Œë”ë§**: `innerHTML` ì‚¬ìš©ìœ¼ë¡œ XSS ì·¨ì•½ì  ê°€ëŠ¥
- âŒ **requestAnimationFrame ë¯¸ì‚¬ìš©**: ì¬ê·€ í˜¸ì¶œì´ ì—†ì–´ ì—°ì† ë Œë”ë§ ë£¨í”„ê°€ ì•„ë‹˜
  - í˜„ì¬ëŠ” `setInterval`ë¡œ ì™¸ë¶€ì—ì„œ íŠ¸ë¦¬ê±°
  - ë§¤ í”„ë ˆì„ë§ˆë‹¤ ì‹¤í–‰ë˜ì§€ ì•Šê³  1ì´ˆë§ˆë‹¤ í•œ ë²ˆì”©ë§Œ ì‹¤í–‰
  - `setInterval`ì´ ì—†ìœ¼ë©´ ë Œë”ë§ì´ í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ê³  ëë‚¨

### 3. ê°œë°œ ê²½í—˜

- âŒ **íƒ€ì… ì•ˆì •ì„± ì—†ìŒ**: TypeScript ë¯¸ì§€ì›
- âŒ **ì—ëŸ¬ ì²˜ë¦¬ ë¶€ì¡±**: ì˜ëª»ëœ ì»´í¬ë„ŒíŠ¸ ë“±ë¡ ì‹œ ëª…í™•í•œ ì—ëŸ¬ ì—†ìŒ
- âŒ **ë””ë²„ê¹… ì–´ë ¤ì›€**: í”„ë ˆì„ì›Œí¬ ë„êµ¬ ì—†ì–´ ë””ë²„ê¹… ë³µì¡

### 4. ìœ ì§€ë³´ìˆ˜

- âŒ **ìˆ˜ë™ ìƒíƒœ ê´€ë¦¬**: ìƒíƒœ ë³€ê²½ ì‹œ ìˆ˜ë™ìœ¼ë¡œ `render()` í˜¸ì¶œ í•„ìš”
- âŒ **ì™¸ë¶€ íŠ¸ë¦¬ê±° ì˜ì¡´**: `setInterval` ê°™ì€ ì™¸ë¶€ íŠ¸ë¦¬ê±°ì— ì˜ì¡´í•˜ì—¬ ë Œë”ë§
- âŒ **ì»´í¬ë„ŒíŠ¸ ê°„ í†µì‹  ë³µì¡**: ì§ì ‘ì ì¸ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ ì—†ìŒ
- âŒ **ì½”ë“œ ì¤‘ë³µ ê°€ëŠ¥**: ë¹„ìŠ·í•œ ë¡œì§ ë°˜ë³µ ê°€ëŠ¥

### 5. í™•ì¥ì„±

- âŒ **ë¼ìš°íŒ… ì—†ìŒ**: SPA ë¼ìš°íŒ… ê¸°ëŠ¥ ë¶€ì¬
- âŒ **ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ìŒ**: Redux, MobX ê°™ì€ ë„êµ¬ ì—†ìŒ
- âŒ **ë¹Œë“œ ë„êµ¬ ì—†ìŒ**: ë²ˆë“¤ë§, ìµœì í™” ë„êµ¬ ì—†ìŒ

---

## ê°œì„  ê°€ëŠ¥í•œ ë¶€ë¶„

### 1. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ê´€ë¦¬

```javascript
// ê°œì„  ì˜ˆì‹œ
const createEventHandlers = (state, render) => {
  return {
    addTodo: (text) => {
      state.todos.push({ text, completed: false });
      render();
    },
    toggleTodo: (index) => {
      state.todos[index].completed = !state.todos[index].completed;
      render();
    },
  };
};
```

### 2. ìƒíƒœ ê´€ë¦¬ ê°œì„ 

```javascript
// ê°œì„  ì˜ˆì‹œ: ìƒíƒœ ë³€ê²½ ê°ì§€
const createState = (initialState) => {
  let state = { ...initialState };
  const listeners = [];

  return {
    getState: () => state,
    setState: (updates) => {
      state = { ...state, ...updates };
      listeners.forEach((listener) => listener(state));
    },
    subscribe: (listener) => {
      listeners.push(listener);
    },
  };
};
```

### 3. ì„±ëŠ¥ ìµœì í™”

```javascript
// ê°œì„  ì˜ˆì‹œ: í‚¤ ê¸°ë°˜ ë¹„êµ
const applyDiffWithKeys = (parentNode, realNode, virtualNode, keyFn) => {
  // í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë…¸ë“œ ë§¤ì¹­ ê°œì„ 
  // ë¶ˆí•„ìš”í•œ ì¬ìƒì„± ë°©ì§€
};
```

### 4. íƒ€ì… ì•ˆì •ì„±

```typescript
// TypeScript ë„ì…
interface Component {
  (targetElement: HTMLElement, state: State): HTMLElement;
}

interface State {
  todos: Todo[];
  currentFilter: Filter;
}
```

### 5. ì—ëŸ¬ ì²˜ë¦¬

```javascript
// ê°œì„  ì˜ˆì‹œ
const renderWrapper = (component) => {
  return (targetElement, state) => {
    if (!targetElement) {
      throw new Error("Target element is required");
    }
    if (!component) {
      throw new Error("Component function is required");
    }
    // ... ê¸°ì¡´ ë¡œì§
  };
};
```

### 6. requestAnimationFrame ê°œì„ 

```javascript
// í˜„ì¬ ì½”ë“œì˜ ë¬¸ì œì 
const render = () => {
  window.requestAnimationFrame(() => {
    // ë Œë”ë§ ë¡œì§
    // ì¬ê·€ í˜¸ì¶œì´ ì—†ì–´ í•œ ë²ˆë§Œ ì‹¤í–‰ë¨
  });
};

// ê°œì„  ì˜ˆì‹œ 1: ìƒíƒœ ë³€ê²½ ê°ì§€ ê¸°ë°˜ ë Œë”ë§
let isRendering = false;
let needsRender = false;

const render = () => {
  if (isRendering) {
    needsRender = true; // ë Œë”ë§ ì¤‘ì´ë©´ í”Œë˜ê·¸ë§Œ ì„¤ì •
    return;
  }

  isRendering = true;
  window.requestAnimationFrame(() => {
    const main = document.querySelector(".todoapp");
    const newMain = registry.renderRoot(main, state);
    applyDiff(document.body, main, newMain);

    isRendering = false;

    if (needsRender) {
      needsRender = false;
      render(); // ë‹¤ìŒ í”„ë ˆì„ì— ë‹¤ì‹œ ë Œë”ë§
    }
  });
};

// ê°œì„  ì˜ˆì‹œ 2: ìƒíƒœ ë³€ê²½ ì‹œ ìë™ ë Œë”ë§
const createState = (initialState) => {
  let state = { ...initialState };

  return new Proxy(state, {
    set(target, property, value) {
      target[property] = value;
      render(); // ìƒíƒœ ë³€ê²½ ì‹œ ìë™ ë Œë”ë§
      return true;
    },
  });
};

const state = createState({
  todos: getTodos(),
  currentFilter: "All",
});

// ì´ì œ ìƒíƒœ ë³€ê²½ë§Œ í•˜ë©´ ìë™ìœ¼ë¡œ ë Œë”ë§ë¨
state.todos = getTodos(); // ìë™ìœ¼ë¡œ render() í˜¸ì¶œ
```

---

## ìš”ì•½

### í˜„ì¬ êµ¬í˜„ ìƒíƒœ

ì´ ì½”ë“œëŠ” **ì‹œì‘ ë‹¨ê³„**ì˜ êµ¬í˜„ì…ë‹ˆë‹¤:

- âœ… **ì„ ì–¸í˜• ë Œë”ë§ íŒ¨í„´**: View = f(State) êµ¬í˜„
- âœ… **ê°€ìƒ DOM ë° Diff ì•Œê³ ë¦¬ì¦˜**: ê¸°ë³¸ êµ¬ì¡° ì™„ì„±
- âš ï¸ **ìˆ˜ë™ ë Œë”ë§**: ìƒíƒœ ë³€ê²½ ì‹œ ìˆ˜ë™ìœ¼ë¡œ `render()` í˜¸ì¶œ í•„ìš”
- âš ï¸ **ì™¸ë¶€ íŠ¸ë¦¬ê±°**: í˜„ì¬ëŠ” `setInterval`ë¡œ ìƒíƒœ ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜
- ğŸ”„ **í–¥í›„ ê°œì„  ì˜ˆì •**: Reactì²˜ëŸ¼ ìƒíƒœ ë³€ê²½ ì‹œ ìë™ ë Œë”ë§ êµ¬í˜„ ì˜ˆì •

### í•µì‹¬ íŒ¨í„´

1. **ì„ ì–¸í˜• ë Œë”ë§**: View = f(State)
2. **ê°€ìƒ DOM**: ì‹¤ì œ DOMê³¼ ë¹„êµí•˜ì—¬ ìµœì†Œí•œì˜ ì—…ë°ì´íŠ¸
3. **ì»´í¬ë„ŒíŠ¸ ì‹œìŠ¤í…œ**: `data-component` ì†ì„±ìœ¼ë¡œ ìë™ ì—°ê²°
4. **Diff ì•Œê³ ë¦¬ì¦˜**: ë³€ê²½ëœ ë¶€ë¶„ë§Œ ì‹ë³„í•˜ì—¬ ì—…ë°ì´íŠ¸
5. **ìƒíƒœ ê¸°ë°˜ ë Œë”ë§**: ìƒíƒœ ë³€ê²½ ì‹œì—ë§Œ ë Œë”ë§ (ì˜ë„ëœ ë™ì‘)

### ì í•©í•œ ì‚¬ìš© ì‚¬ë¡€

- âœ… ì‘ì€ ê·œëª¨ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜
- âœ… í”„ë ˆì„ì›Œí¬ ì—†ì´ ìˆœìˆ˜ JavaScriptë¡œ êµ¬í˜„í•˜ê³  ì‹¶ì„ ë•Œ
- âœ… í•™ìŠµ ëª©ì  (React ê°™ì€ í”„ë ˆì„ì›Œí¬ì˜ ì›ë¦¬ ì´í•´)
- âœ… ë²ˆë“¤ í¬ê¸°ê°€ ì¤‘ìš”í•œ í™˜ê²½

### ë¶€ì í•©í•œ ì‚¬ìš© ì‚¬ë¡€

- âŒ ë³µì¡í•œ ìƒíƒœ ê´€ë¦¬ê°€ í•„ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜
- âŒ ëŒ€ê·œëª¨ íŒ€ í”„ë¡œì íŠ¸
- âŒ ë¹ ë¥¸ ê°œë°œ ì†ë„ê°€ í•„ìš”í•œ í”„ë¡œì íŠ¸
- âŒ í’ë¶€í•œ ìƒíƒœê³„ê°€ í•„ìš”í•œ í”„ë¡œì íŠ¸

---

## ê´€ë ¨ íŒŒì¼

- [index.js](index.js) - ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
- [registry.js](registry.js) - ì»´í¬ë„ŒíŠ¸ ë“±ë¡ ì‹œìŠ¤í…œ
- [applyDiff.js](applyDiff.js) - Diff ì•Œê³ ë¦¬ì¦˜
- [view/todos.js](view/todos.js) - Todo ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸
- [view/filters.js](view/filters.js) - í•„í„° ì»´í¬ë„ŒíŠ¸
- [view/counter.js](view/counter.js) - ì¹´ìš´í„° ì»´í¬ë„ŒíŠ¸
